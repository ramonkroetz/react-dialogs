"use strict";"use client";var f=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var I=(o,r)=>{for(var a in r)f(o,a,{get:r[a],enumerable:!0})},x=(o,r,a,e)=>{if(r&&typeof r=="object"||typeof r=="function")for(let l of T(r))!R.call(o,l)&&l!==a&&f(o,l,{get:()=>r[l],enumerable:!(e=M(r,l))||e.enumerable});return o};var k=o=>x(f({},"__esModule",{value:!0}),o);var L={};I(L,{Dialog:()=>S,DialogContext:()=>m,DialogProvider:()=>E,useDialog:()=>P});module.exports=k(L);var y=require("motion/react"),D=require("react"),O=require("react-remove-scroll"),w=require("react-use");var p=require("react");var t=require("react"),h=require("react-dom"),v=require("react-use"),g=require("react/jsx-runtime"),C={modals:{},show:()=>{},close:()=>{},overlayOrder:[],updateProps:()=>{}},m=(0,t.createContext)(C);function A(o,{type:r,payload:a}){switch(r){case"ShowModal":{let{modalId:e,props:l}=a;return{...o,overlayOrder:[...o.overlayOrder,e],modals:{...o.modals,[e]:{...o.modals[e],isOpen:!0,props:l}}}}case"CloseModal":{let{modalId:e}=a;return{...o,overlayOrder:o.overlayOrder.filter(l=>l!==e),modals:{...o.modals,[e]:{...o.modals[e],isOpen:!1}}}}case"CloseTopModal":{if(o.overlayOrder.length===0)return o;let e=o.overlayOrder[o.overlayOrder.length-1];return{...o,overlayOrder:o.overlayOrder.slice(0,-1),modals:{...o.modals,[e]:{...o.modals[e],isOpen:!1}}}}case"UpdatePropsModal":{let{modalId:e,props:l}=a;return{...o,modals:{...o.modals,[e]:{...o.modals[e],props:l}}}}}}function E({children:o,dialogs:r}){let[a,e]=(0,t.useReducer)(A,C);(0,v.useEvent)("keydown",n=>{(n.key==="Esc"||n.key==="Escape"&&a.overlayOrder.length>0)&&e({type:"CloseTopModal"})});let l=(0,t.useCallback)((n,s={})=>{e({type:"ShowModal",payload:{modalId:n,props:s}})},[]),i=(0,t.useCallback)(n=>{e({type:"CloseModal",payload:{modalId:n}})},[]),d=(0,t.useCallback)((n,s)=>{e({type:"UpdatePropsModal",payload:{modalId:n,props:s}})},[]),c=(0,t.useMemo)(()=>({...a,show:l,close:i,updateProps:d}),[a,l,i,d]);return(0,g.jsxs)(m.Provider,{value:c,children:[o,(0,g.jsx)(N,{children:r})]})}var N=({children:o})=>{let r=document.body;return(0,h.createPortal)(o,r)};function P(o){let{modals:r,overlayOrder:a,show:e,close:l,updateProps:i}=(0,p.useContext)(m),d=(0,p.useCallback)(s=>e(o,s||{}),[e,o]),c=(0,p.useCallback)(()=>l(o),[o,l]),n=(0,p.useCallback)(s=>i(o,s||{}),[o,i]);return{show:d,close:c,updateProps:n,isOpen:r[o]?.isOpen??!1,props:r[o]?.props,isTopDialog:a.length>0&&o===a[a.length-1]}}var u=require("react/jsx-runtime"),b={initial:{opacity:0,scale:.75},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.75}};function S({id:o,children:r,animation:a=b,onClickAwayCallback:e}){let l=(0,D.useRef)(null),{isOpen:i,close:d,isTopDialog:c}=P(o);(0,w.useClickAway)(l,()=>{setTimeout(()=>{i&&c&&(e?.(),d())},0)});let n=a??{};return(0,u.jsx)(y.AnimatePresence,{children:i&&(0,u.jsx)(y.motion.dialog,{...n,className:"react-dialog",onCancel:s=>s.preventDefault(),ref:s=>{s&&s.showModal()},children:(0,u.jsx)(O.RemoveScroll,{className:"react-dialog-content",ref:l,children:r})})})}
//# sourceMappingURL=index.cjs.map