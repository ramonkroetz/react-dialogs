"use client";import{AnimatePresence as R,motion as I}from"motion/react";import{useRef as x}from"react";import{RemoveScroll as k}from"react-remove-scroll";import{useClickAway as A}from"react-use";import{useCallback as m,useContext as T}from"react";import{createContext as f,useCallback as p,useMemo as P,useReducer as h}from"react";import{createPortal as v}from"react-dom";import{useEvent as C}from"react-use";import{jsx as w,jsxs as M}from"react/jsx-runtime";var u={modals:{},show:()=>{},close:()=>{},overlayOrder:[],updateProps:()=>{}},c=f(u);function D(o,{type:s,payload:l}){switch(s){case"ShowModal":{let{modalId:e,props:r}=l;return{...o,overlayOrder:[...o.overlayOrder,e],modals:{...o.modals,[e]:{...o.modals[e],isOpen:!0,props:r}}}}case"CloseModal":{let{modalId:e}=l;return{...o,overlayOrder:o.overlayOrder.filter(r=>r!==e),modals:{...o.modals,[e]:{...o.modals[e],isOpen:!1}}}}case"CloseTopModal":{if(o.overlayOrder.length===0)return o;let e=o.overlayOrder[o.overlayOrder.length-1];return{...o,overlayOrder:o.overlayOrder.slice(0,-1),modals:{...o.modals,[e]:{...o.modals[e],isOpen:!1}}}}case"UpdatePropsModal":{let{modalId:e,props:r}=l;return{...o,modals:{...o.modals,[e]:{...o.modals[e],props:r}}}}}}function L({children:o,dialogs:s}){let[l,e]=h(D,u);C("keydown",a=>{(a.key==="Esc"||a.key==="Escape"&&l.overlayOrder.length>0)&&e({type:"CloseTopModal"})});let r=p((a,n={})=>{e({type:"ShowModal",payload:{modalId:a,props:n}})},[]),t=p(a=>{e({type:"CloseModal",payload:{modalId:a}})},[]),i=p((a,n)=>{e({type:"UpdatePropsModal",payload:{modalId:a,props:n}})},[]),d=P(()=>({...l,show:r,close:t,updateProps:i}),[l,r,t,i]);return M(c.Provider,{value:d,children:[o,w(O,{children:s})]})}var O=({children:o})=>{let s=document.body;return v(o,s)};function y(o){let{modals:s,overlayOrder:l,show:e,close:r,updateProps:t}=T(c),i=m(n=>e(o,n||{}),[e,o]),d=m(()=>r(o),[o,r]),a=m(n=>t(o,n||{}),[o,t]);return{show:i,close:d,updateProps:a,isOpen:s[o]?.isOpen??!1,props:s[o]?.props,isTopDialog:l.length>0&&o===l[l.length-1]}}import{jsx as g}from"react/jsx-runtime";var E={initial:{opacity:0,scale:.75},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.75}};function z({id:o,children:s,animation:l=E,onClickAwayCallback:e}){let r=x(null),{isOpen:t,close:i,isTopDialog:d}=y(o);A(r,()=>{setTimeout(()=>{t&&d&&(e?.(),i())},0)});let a=l??{};return g(R,{children:t&&g(I.dialog,{...a,className:"react-dialog",onCancel:n=>n.preventDefault(),ref:n=>{n&&n.showModal()},children:g(k,{className:"react-dialog-content",ref:r,children:s})})})}export{z as Dialog,c as DialogContext,L as DialogProvider,y as useDialog};
//# sourceMappingURL=index.js.map